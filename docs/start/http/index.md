## HTTP协议

HTTP协议（HyperText Transfer Protocol，超文本传输协议）是因特网上应用最为广泛的一种网络传输协议，所有的WWW文件都必须遵守这个标准。HTTP是一个`基于TCP/IP通信协议`来传递数据（HTML 文件, 图片文件, 查询结果等）

**特点：**

+ 支持客户/服务器模式。支持基本认证和安全认证。

+ 简单快速：客户向服务器请求服务时，只需传送请求方法和路径。

+ 灵活：HTTP允许传输任意类型的数据对象。正在传输的类型由Content-Type加以标记。

+ 持续连接:

  + HTTP 0.9和1.0使用`非持续连接`：限制每次连接只处理一个请求，服务器处理完客户的请求，并收到客户的应答后，即断开连接。

  + HTTP 1.1使用`持续连接`：不必为每个web对象创建一个新的连接，一个连接可以传送多个对象，采用这种方式可以节省传输时间。

    > 从HTTP/1.1起，默认都开启了`Keep-Alive`，保持连接特性，简单地说，当一个网页打开完成后，客户端和服务器之间用于传输HTTP数据的TCP连接不会关闭，如果客户端再次访问这个服务器上的网页，会继续使用这一条已经建立的连接。
    > Keep-Alive不会永久保持连接，它有一个保持时间，可以在不同的服务器软件（如Apache）中设定这个时间。

+ 无状态：HTTP协议是无状态协议。

## 发起流程

+ 首先客户机与服务器需要建立连接。只要单击某个超级链接，HTTP工作开始。
+ 建立连接后，客户机发送一个请求给服务器，请求方式的格式为：统一资源标识符（URL）、协议版本号，后边是MIME信息包括请求修饰符、客户机信息和可能的内容。
+ 服务器接到请求后，给予相应的响应信息，其格式为一个状态行，包括信息的协议版本号、一个成功或错误的代码，后边是MIME信息包括服务器信息、实体信息和可能的内容。
+ 客户端接收服务器所返回的信息通过浏览器显示在用户的显示屏上，然后客户机与服务器断开连接。

## TCP的三次握手四次挥手

![Java面试知识点：TCP 三次握手和四次挥手协议- 知乎](https://pic4.zhimg.com/80/v2-eb29f507ba4513063153ea2fb0c3d05f_1440w.jpg)

## 头域

### 请求信息

请求行、消息报头、请求正文

### 请求方法

HTTP1.0 三种（`POST、GET、HEAD`）

HTTP1.1新增了六种（`OPTIONS、PUT、PATCH、DELETE、TRACE 和CONNECT`）

### 响应消息

客户端向服务器发送一个请求，服务器以一个状态行作为响应，响应的内容包括：`消息协议的版本、成功或者错误编码、服务器信息、实体元信息以及必要的实体内容`。

### 常见的请求头

在HTTP/1.1 协议中，所有的请求头，除Host外，都是可选的

[常用请求头/响应头](http://caibaojian.com/http-protocol.html)



## 解决HTTP无状态的问题

+ **通过Cookies保存状态信息**

  通过Cookies，服务器就可以清楚的知道请求2和请求1来自同一个客户端

+ **通过Session保存状态信息**

  实现方法：

  1. 使用Cookie来实现

     服务器给每个Session分配一个唯一的JSESSIONID，并通过Cookie发送给客户端。
     当客户端发起新的请求的时候，将在Cookie头中携带这个JSESSIONID。这样服务器能够找到这个客户端对应的Session。

  2. 使用URL回写来实现

     URL回写是指服务器在发送给浏览器页面的所有链接中都携带JSESSIONID的参数，这样客户端点击任何一个链接都会把JSESSIONID带会服务器。如果直接在浏览器输入服务端资源的url来请求该资源，那么Session是匹配不到的。

+ **通过表单变量保持状态**

  ```html
  <input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKMjA0OTM4MTAwNGRkXUfhlDv1Cs7/qhBlyZROCzlvf5U=" />
  ```

+ **通过QueryString保持状态**

  QueryString通过将信息保存在所请求地址的末尾来向服务器传送信息，通常和表单结合使用

参考文章：
+ [一篇比较全的HTTP协议详解](http://caibaojian.com/http-protocol.html)